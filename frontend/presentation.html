<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Bobibo Architecture - Code Walkthrough</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="styles.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/xml.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>

    <style>
        /* Presentation specific styles */
        body {
            overflow: hidden; /* Prevent scrolling, treat like slides */
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .presentation-container {
            flex: 1;
            position: relative;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
            padding: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            display: none; /* Hidden by default */
            width: 100%;
            height: 100%;
            flex-direction: column;
            justify-content: center;
            animation: fadeIn 0.5s ease;
        }

        .slide.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 1px solid var(--border-soft);
            max-height: 80vh;
            overflow-y: auto;
        }

        .slide h2 {
            color: var(--brand-blue);
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .slide h3 {
            color: #555;
            margin-bottom: 0.5rem;
        }

        .code-block {
            margin: 1rem 0;
            border-radius: 8px;
            overflow: hidden;
            font-size: 0.9rem;
        }

        .controls {
            padding: 1rem;
            background: white;
            border-top: 1px solid var(--border-soft);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }

        .progress-bar {
            flex: 1;
            height: 6px;
            background: #eee;
            margin: 0 20px;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--brand-blue);
            width: 0%;
            transition: width 0.3s ease;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            align-items: start;
        }

        /* Mobile adaptation */
        @media (max-width: 768px) {
            .grid-2 { grid-template-columns: 1fr; }
            .slide h2 { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <header>
        <h1>Bobibo - Architecture Presentation</h1>
    </header>

    <div class="presentation-container">

        <div class="slide active">
            <div class="slide-content" style="text-align: center;">
                <h2>Bobibo Product Store</h2>
                <h3>A "No-JS" Framework E-Commerce Solution</h3>
                <p style="font-size: 1.2rem; margin: 2rem 0; color: #666;">
                    Built with <strong>Go</strong>, <strong>HTMX</strong>, and <strong>PostgreSQL</strong>.
                </p>
                <div style="display: flex; justify-content: center; gap: 20px;">
                    <button onclick="nextSlide()">Start Walkthrough &rarr;</button>
                </div>
            </div>
        </div>

        <div class="slide">
            <div class="slide-content">
                <h2>The Tech Stack</h2>
                <div class="grid-2">
                    <div>
                        <h3>Backend: Go (Golang)</h3>
                        <p>High-performance backend handling routing, database logic, and HTML rendering.</p>
                        <ul style="margin-top: 1rem;">
                            <li><strong>Gin:</strong> Web framework</li>
                            <li><strong>GORM:</strong> ORM for PostgreSQL</li>
                        </ul>
                    </div>
                    <div>
                        <h3>Frontend: HTMX</h3>
                        <p>Allows us to access AJAX, CSS Transitions, WebSockets and Server Sent Events directly in HTML.</p>
                        <ul style="margin-top: 1rem;">
                            <li>No complex JS bundles</li>
                            <li>Server-Driven UI (HTML over the wire)</li>
                        </ul>
                    </div>
                </div>
                <div style="margin-top: 2rem;">
                    <h3>Infrastructure</h3>
                    <p>Fully containerized with <strong>Docker</strong> for easy deployment.</p>
                    <div class="code-block">
                        <pre><code class="language-dockerfile"># Backend Dockerfile
FROM golang:latest
WORKDIR /app
COPY . .
RUN go build -o main .
CMD ["./main"]</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <div class="slide">
            <div class="slide-content">
                <h2>Flow 1: Browsing Products</h2>
                <p>Instead of fetching JSON, the frontend requests HTML. The magic happens in the <code>hx-get</code> attribute.</p>

                <div class="grid-2">
                    <div>
                        <h3>Frontend (index.html)</h3>
                        <p>When clicked, HTMX fetches data and swaps the <code>outerHTML</code> of the target container.</p>
                        <div class="code-block">
<pre><code class="language-xml">&lt;button
    hx-get="/products?product_type=smartphones..."
    hx-target="#product-view-area"
    hx-swap="outerHTML"&gt;
    View Smartphones
&lt;/button&gt;

&lt;div id="product-view-area"&gt;
    &lt;!-- Content is swapped here --&gt;
&lt;/div&gt;</code></pre>
                        </div>
                    </div>
                    <div>
                        <h3>What happens?</h3>
                        <ol>
                            <li>User clicks button.</li>
                            <li>Browser sends GET to <code>/products</code>.</li>
                            <li>Server returns a list of products as HTML.</li>
                            <li>HTMX replaces the button's target area with that HTML.</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <div class="slide">
            <div class="slide-content">
                <h2>Flow 1: The Backend Handler</h2>
                <p>The Go backend handles the request and renders a template instead of JSON.</p>

                <div class="code-block">
<pre><code class="language-go">func (dbc *DBContext) HandleGetProducts(c *gin.Context) {
    // 1. Parse parameters
    offset, _ := strconv.Atoi(c.Param("offset"))
    filter := c.Param("filter")

    // 2. Query Database (GORM)
    var products []models.Product
    dbc.DB.Where("category = ?", filter).Find(&products)

    // 3. Render HTML Template
    // We send "productsTemplate.html" with the data
    c.HTML(200, "productsTemplate.html", products)
}</code></pre>
                </div>
                <p><strong>Note:</strong> <code>c.HTML</code> is key here. It tells the template engine to parse the file and fill it with the <code>products</code> data.</p>
            </div>
        </div>

        <div class="slide">
            <div class="slide-content">
                <h2>Flow 2: Adding to Cart</h2>
                <p>We use <code>hx-post</code> to send data to the server and update the Cart UI immediately.</p>

                <div class="grid-2">
                    <div>
                        <h3>The Template (productTemplate.html)</h3>
                        <p>This template is rendered by the server for each product.</p>
                        <div class="code-block">
<pre><code class="language-xml">&lt;div class="product-box"&gt;
    &lt;h3&gt;{{.Name}}&lt;/h3&gt;
    &lt;p&gt;{{.Price}}&lt;/p&gt;
&lt;/div&gt;

&lt;!-- Hidden input for ID --&gt;
&lt;input type="hidden" name="product_id" value="{{.ID}}"&gt;

&lt;!-- HTMX Action --&gt;
&lt;button
    hx-post="/cart/user123/add/{{.ID}}"
    hx-include="[name='product_id']"
    hx-target="#cart-view"
    hx-swap="innerHTML"&gt;
    Add to Cart
&lt;/button&gt;</code></pre>
                        </div>
                    </div>
                    <div>
                        <h3>The Target (index.html)</h3>
                        <p>The cart sidebar waits for updates.</p>
                        <div class="code-block">
<pre><code class="language-xml">&lt;aside id="shopping-cart-container"&gt;
    &lt;h2&gt;üõí Your Cart&lt;/h2&gt;

    &lt;div id="cart-view"
         hx-get="/cart/user123"
         hx-trigger="load, cartUpdated from:body"&gt;
        &lt;p&gt;Loading cart...&lt;/p&gt;
    &lt;/div&gt;
&lt;/aside&gt;</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="slide">
            <div class="slide-content">
                <h2>Data Persistence</h2>
                <p>We use PostgreSQL with a robust schema for Users, Products, and Carts.</p>

                <div class="code-block">
<pre><code class="language-sql">-- Products Table
CREATE TABLE products (
    id INTEGER PRIMARY KEY,
    name TEXT NOT NULL,
    price DECIMAL NOT NULL,
    category category NOT NULL, -- Custom ENUM type
    attributes JSONB -- Flexible JSON for specs
);

-- Carts Table (Relational)
CREATE TABLE carts (
    user_id UUID PRIMARY KEY REFERENCES users(id),
    item_id INTEGER REFERENCES products(id),
    quantity INT DEFAULT 1
);</code></pre>
                </div>
            </div>
        </div>

        <div class="slide">
            <div class="slide-content" style="text-align: center;">
                <h2>Thank You!</h2>
                <h3>Why this works:</h3>
                <ul style="list-style: none; padding: 0; font-size: 1.2rem; margin: 2rem 0; line-height: 2;">
                    <li>üöÄ <strong>Fast:</strong> Low latency, small payload sizes.</li>
                    <li>üß© <strong>Simple:</strong> Frontend state is managed by the Server.</li>
                    <li>üõ†Ô∏è <strong>Maintainable:</strong> Clear separation of concerns in Go.</li>
                </ul>
                <div style="display: flex; justify-content: center; gap: 20px;">
                    <a href="index.html"><button>Go to Live Store</button></a>
                </div>
            </div>
        </div>

    </div>

    <div class="controls">
        <button class="btn-secondary" onclick="prevSlide()">Previous</button>
        <div class="progress-bar">
            <div class="progress-fill" id="progress"></div>
        </div>
        <button onclick="nextSlide()">Next</button>
    </div>

    <script>
        // Slideshow Logic
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const progress = document.getElementById('progress');

        function showSlide(index) {
            slides.forEach((slide, i) => {
                slide.classList.remove('active');
                if (i === index) slide.classList.add('active');
            });
            updateProgress();

            // Re-highlight code blocks when they become visible
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
        }

        function nextSlide() {
            if (currentSlide < slides.length - 1) {
                currentSlide++;
                showSlide(currentSlide);
            }
        }

        function prevSlide() {
            if (currentSlide > 0) {
                currentSlide--;
                showSlide(currentSlide);
            }
        }

        function updateProgress() {
            const percentage = ((currentSlide) / (slides.length - 1)) * 100;
            progress.style.width = percentage + '%';
        }

        // Initialize syntax highlighting
        hljs.highlightAll();
        updateProgress();

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') nextSlide();
            if (e.key === 'ArrowLeft') prevSlide();
        });
    </script>
</body>
</html>
